<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>SNRi Target Training for Joint Speech Enhancement and Recognition</title>
      <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
      <!-- <link rel="shortcut icon" href="../../images/taco.png"> -->
      <script>
         function play(path) {{
           var player = document.getElementById('player');
           player.src = path;
           player.play();
         }}
      </script>
      <style>
         .audio-cell {
         /* Center audio widgets in the table cell. */
         text-align: center;
         padding-bottom: 1px;
         padding-top: 1px;
         }
         .audio-cell-padded {
         text-align: center;
         padding-bottom: 10px;
         padding-top: 10px;
         }
         .audio-header {
         /* Don't wrap header text. */
         white-space: nowrap;
         /* Some breaking space between headers for readability. */
         padding-right: 5px;
         padding-left: 5px;
         }
         .reference-cell {
         /* For uniformity and to wrap long reference text, limit the reference cell's width. */
         width: 25%;
         padding-top: 20px;
         padding-bottom: 20px;
         }
         .sample audio {
         vertical-align: middle;
         padding-left: 3px;
         padding-right: 3px;
         }
         .round-button {
         box-sizing: border-box;
         display:block;
         width:30px;
         height:30px;
         padding-top: 8px;
         padding-left: 3px;
         line-height: 6px;
         border: 1.2px solid #000;
         border-radius: 50%;
         color: #000;
         text-align:center;
         background-color: rgba(0,0,0,0.00);
         font-size:6px;
         box-shadow: 0px 0px 2px rgba(0,0,0,1);
         transition: all 0.2s ease;
         }
         .round-button:hover {
         background-color: rgba(0,0,0,0.0);
         box-shadow: 0px 0px 4px rgba(0,0,0,1);
         }
         .round-button:active {
         background-color: rgba(0,0,0,0.01);
         box-shadow: 0px 0px 1px rgba(0,0,0,1);
         }
      </style>
   </head>

   <body>
     <div class="main">
       <article>
         <header>
            <h1>SNRi Target Training for Joint Speech Enhancement and Recognition [<a href="https://arxiv.org/abs/2111.00764">paper</a>]</h1>		  
         </header>
      </article>
      <div>
        <p>
		<a href="https://sites.google.com/site/yumakoizumiweb/profile-english">Yuma Koizumi</a>,
	  	<a href="https://research.google/people/ShigekiKarita/">Shigeki Karita</a>,
	  	<a href="https://research.google/people/ArunNarayanan/">Arun Narayanan</a>,
		<a href="https://scholar.google.com/citations?user=Iu6b4XcAAAAJ&hl=en">Sankaran Panchapagesan</a>,
	  	<a href="http://bacchiani.net/resume/resume.html">Michiel Bacchiani</a>
		</p>
      </div>


      <p><b>Abstract:</b> Speech enhancement (SE) is used as a frontend in speech applications including automatic speech recognition (ASR) and telecommunication. A difficulty in using the SE frontend is that the appropriate noise reduction level differs depending on applications and/or noise characteristics. In this study, we propose "signal-to-noise ratio improvement (SNRi) target training"; the SE frontend is trained to output a signal whose SNRi is controlled by an auxiliary scalar input. In joint training with a backend, the target SNRi value is estimated by an auxiliary network. By training all networks to minimize the backend task loss, we can estimate the appropriate noise reduction level for each noisy input in a data-driven scheme. Our experiments showed that the SNRi target training enables control of the output SNRi. In addition, the proposed joint training relatively reduces word error rate by 4.0\% and 5.7\% compared to a Conformer-based standard ASR model and conventional SE-ASR joint training model, respectively. Furthermore, by analyzing the predicted target SNRi, we observed the jointly trained network automatically controls the target SNRi according to noise characteristics.
      </p>
	<p>
  		<b>NOTE: </b>Noisy samples were generated by mixing samples from two datasets: speech from the same dataset as WaveGrad [1] and noise from the TAU Urban Audio-Visual Scenes 2021 dataset [2].  Therefore, there is a discrepancy between training and test samples.
	</p>

      <h2>
        Contents:
      </h2>
      <p>
  <a href="#enhancement">Audio examples for output SNRi control</a><br>
  <a href="#asr">Output examples for joint SE-ASR training</a><br>
  <a href="#references">References</a><br>
      </p>


  <h2 id="enhancement">Audio examples for output SNRi control</h2>

  <p><span class="section"><b>Example 1</b></span></p>
  <b>Text: </b><I>I can't speak for Scooby, but have you looked in the Mystery Machine?</I><br />
  <table style="width:100%">
    <tr>
        <td align="center"> Noisy input <br />
          <img src="data/0_input.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_input.wav"></audio>
        </td>
        <td align="center"> Clean speech <br />
          <img src="data/0_clean.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_clean.wav"></audio>
        </td>
    </tr>
        <td align="center"> Target SNRi = 3.0 dB <br />
          <img src="data/0_3.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_3.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 6.0 dB <br />
          <img src="data/0_6.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_6.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 9.0 dB <br />
          <img src="data/0_9.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_9.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 12.0 dB <br />
          <img src="data/0_12.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/0_12.0dB.wav"></audio>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <p><span class="section"><b>Example 2</b></span></p>
  <b>Text: </b><I>The dreaded, head pounding, body aching, feverish, nauseating, cough fest packs equal parts misery and inconvenience.</I><br />
  Ground truth: <br />
  <table style="width:100%">
    <tr>
        <td align="center"> Noisy input <br />
          <img src="data/1_input.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_input.wav"></audio>
        </td>
        <td align="center"> Clean speech <br />
          <img src="data/1_clean.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_clean.wav"></audio>
        </td>
    </tr>
        <td align="center"> Target SNRi = 3.0 dB <br />
          <img src="data/1_3.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_3.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 6.0 dB <br />
          <img src="data/1_6.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_6.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 9.0 dB <br />
          <img src="data/1_9.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_9.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 12.0 dB <br />
          <img src="data/1_12.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/1_12.0dB.wav"></audio>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <p><span class="section"><b>Example 3</b></span></p>
  <b>Text: </b><I>There are many talented actors in the world.</I><br />
  <table style="width:100%">
    <tr>
        <td align="center"> Noisy input <br />
          <img src="data/2_input.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_input.wav"></audio>
        </td>
        <td align="center"> Clean speech <br />
          <img src="data/2_clean.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_clean.wav"></audio>
        </td>
    </tr>
        <td align="center"> Target SNRi = 3.0 dB <br />
          <img src="data/2_3.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_3.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 6.0 dB <br />
          <img src="data/2_6.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_6.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 9.0 dB <br />
          <img src="data/2_9.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_9.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 12.0 dB <br />
          <img src="data/2_12.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/2_12.0dB.wav"></audio>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <p><span class="section"><b>Example 4</b></span></p>
  <b>Text: </b><I>Aromatherapy. The use of aromatic plant extracts and essential oils in massage or baths.</I><br />
  <table style="width:100%">
    <tr>
        <td align="center"> Noisy input <br />
          <img src="data/3_input.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_input.wav"></audio>
        </td>
        <td align="center"> Clean speech <br />
          <img src="data/3_clean.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_clean.wav"></audio>
        </td>
    </tr>
        <td align="center"> Target SNRi = 3.0 dB <br />
          <img src="data/3_3.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_3.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 6.0 dB <br />
          <img src="data/3_6.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_6.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 9.0 dB <br />
          <img src="data/3_9.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_9.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 12.0 dB <br />
          <img src="data/3_12.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/3_12.0dB.wav"></audio>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
 
  <p><span class="section"><b>Example 5</b></span></p>
  <b>Text: </b><I>Nine hundred kilowatts times twenty four is a lot of watts.</I><br />
  <table style="width:100%">
    <tr>
        <td align="center"> Noisy input <br />
          <img src="data/4_input.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_input.wav"></audio>
        </td>
        <td align="center"> Clean speech <br />
          <img src="data/4_clean.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_clean.wav"></audio>
        </td>
    </tr>
        <td align="center"> Target SNRi = 3.0 dB <br />
          <img src="data/4_3.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_3.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 6.0 dB <br />
          <img src="data/4_6.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_6.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 9.0 dB <br />
          <img src="data/4_9.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_9.0dB.wav"></audio>
        </td>
        <td align="center"> Target SNRi = 12.0 dB <br />
          <img src="data/4_12.0dB.png" width="300" alt=""/> <br />
          <audio controls=""><source src="data/4_12.0dB.wav"></audio>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->






  <br/>
  <h2 id="asr">Output examples for joint SE-ASR training</h2>

  <a href="#ex1">Example 1</a><br>
  <a href="#ex2">Example 2</a><br>
  <a href="#ex3">Example 3</a><br>
  <a href="#ex4">Example 4</a><br>
  <a href="#ex5">Example 5</a>

  <h3 id="ex1">Example 1</h3>
  <table style="width:100%">
    <tr>
        <td align="left"> 
		<b>Noisy input</b><br />
  		<b>Ground-truth transcript: </b><I>I can't speak for Scooby, but have you looked in the Mystery Machine?</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/0_asr_noisy.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/0_asr_noisy.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>Conventional SE + ASR joint training </b><br />
  		<b>Predicted transcript: </b><I>I can't speak for Scooby but have you looked in the Mystery Machine</I><br />
        <p style="text-align: center">
          <img src="data/0_asr.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/0_asr.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>SNRi target training + ASR joint training</b><br />
  		<b>Predicted transcript: </b><I>I can't speak for Scooby but have you looked in the Mystery Machine</I><br />
        <p style="text-align: center">
          <img src="data/0_snri.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/0_snri.wav"></audio>
        </p>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <h3 id="ex2">Example 2</h3>
  <table style="width:100%">
    <tr>
        <td align="left"> 
		<b>Noisy input</b><br />
  		Ground-truth transcript: <I>The dreaded, head pounding, body aching, feverish, nauseating, cough fest packs equal parts misery and inconvenience.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/1_asr_noisy.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/1_asr_noisy.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>Conventional SE + ASR joint training </b><br />
  		<b>Predicted transcript: </b><I>The dreaded head <span style="color:red">founding bodying</span> feverish <span style="color:red">nosiating confess perhaps</span> equal parts misery and inconvenience.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/1_asr.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/1_asr.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>SNRi target training + ASR joint training</b><br />
  		<b>Predicted transcript: </b><I>The dreaded head <span style="color:red">founding</span> body aching feverish nauseating <span style="color:red">confess taxi pro</span> parts misery and inconvenience</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/1_snri.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/1_snri.wav"></audio>
        </p>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <h3 id="ex3">Example 3</h3>
  <table style="width:100%">
    <tr>
        <td align="left"> 
		<b>Noisy input</b><br />
  		<b>Ground-truth transcript: </b><I>There are many talented actors in the world.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/2_asr_noisy.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/2_asr_noisy.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>Conventional SE + ASR joint training </b><br />
  		<b>Predicted transcript: </b><I>There are many <span style="color:red">town to the</span> actors in the world.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/2_asr.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/2_asr.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>SNRi target training + ASR joint training</b><br />
  		<b>Predicted transcript: </b><I>There are many talented actors in the world.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/2_snri.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/2_snri.wav"></audio>
        </p>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <h3 id="ex4">Example 4</h3>
  <table style="width:100%">
    <tr>
        <td align="left"> 
		<b>Noisy input</b><br />
  		<b>Ground-truth transcript: </b><I>Aromatherapy. The use of aromatic plant extracts and essential oils in massage or baths.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/3_asr_noisy.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/3_asr_noisy.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>Conventional SE + ASR joint training </b><br />
  		<b>Predicted transcript: </b><I><span style="color:red">A Roman</span> therapy the use of <span style="color:red">aramatic</span> plant extracts and essential <span style="color:red">loyals</span> in massage or <span style="color:red">backs</span>.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/3_asr.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/3_asr.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>SNRi target training + ASR joint training</b><br />
  		<b>Predicted transcript: </b><I><span style="color:red">A Rome</span> therapy the use of aromatic plant extracts and essential oils in massage or <span style="color:red">bats</span>.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/3_snri.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/3_snri.wav"></audio>
        </p>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->

  <h3 id="ex5">Example 5</h3>
  <table style="width:100%">
    <tr>
        <td align="left"> 
		<b>Noisy input</b><br />
  		<b>Ground-truth transcript: </b><I>Nine hundred kilowatts times twenty four is a lot of watts.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/4_asr_noisy.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/4_asr_noisy.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>Conventional SE + ASR joint training </b><br />
  		<b>Predicted transcript: </b><I>Nine hundred <span style="color:red">kilogs</span> times twenty four is a lot of <span style="color:red">wots</span>.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/4_asr.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/4_asr.wav"></audio>
        </p>
        </td>
    <tr>
    </tr>
        <td align="left"> 
		<b>SNRi target training + ASR joint training</b><br />
  		<b>Predicted transcript: </b><I>Nine hundred <span style="color:red">kilogs</span> times twenty four is a lot of watts.</I><br />
		</b>
        <p style="text-align: center">
          <img src="data/4_snri.png" width="600" alt=""/> <br />
          <audio controls=""><source src="data/4_snri.wav"></audio>
        </p>
        </td>
    </tr>
  </table>
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->
  <!----------------------------------------------------------------------------------------------------------------------------------------------------------------->


  <h3 id="references">References:</h3>
         <p>
		[1] N. Chen, Y. Zhang, H. Zen, R. J. Weiss, M. Norouzi, and W. Chan,“WaveGrad:  Estimating gradients for waveform generation,”  in Proc. Int. Conf. Learn. Represent. (ICLR), 2021. [<a href="https://openreview.net/forum?id=NsMLjcFaO8O">paper</a>]<br/>
  		[2] S. Wang, A. Mesaros, T. Heittola, and T. Virtanen, “A curated dataset of urban scenes for audio-visual scene analysis,” in Proc. Int. Conf. on  Acoust., Speech, and Signal Process. (ICASSP), 2021 [<a href="https://arxiv.org/abs/2011.00030">paper</a>]<br />
         </p>

</div>
</body>
</html>
